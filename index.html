<!DOCTYPE html>
<html>
<head>
    <title>Live Stats</title>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <style>
        body { font-family: sans-serif; background: #1a1a1a; color: white; text-align: center; padding: 20px; }
        #viewer-box { font-size: 3em; color: #ff4500; margin: 20px; font-weight: bold; }
        #chat-box { 
            height: 400px; overflow-y: auto; border: 1px solid #444; 
            padding: 15px; text-align: left; background: #222;
            max-width: 600px; margin: 0 auto; border-radius: 8px;
        }
        .message { margin-bottom: 8px; border-bottom: 1px solid #333; padding-bottom: 4px; }
        .author { color: #00d4ff; }
    </style>
</head>
<body>
    <h1>Stream Dashboard</h1>
    <div id="viewer-box">ðŸ‘€ <span id="count">0</span> Viewers</div>
    <div id="chat-box"></div>

    <script>
        // Connecting without a URL automatically points to the hosting server
        const socket = io(); 
        
        const countEl = document.getElementById('count');
        const chatBox = document.getElementById('chat-box');

        socket.on('viewerCount', (count) => {
            countEl.innerText = count.toLocaleString();
        });

        socket.on('newMessages', (messages) => {
            messages.forEach(msg => {
                const div = document.createElement('div');
                div.className = 'message';
                const author = msg.authorDetails?.displayName || "Anonymous";
                const text = msg.snippet?.displayMessage || "";
                div.innerHTML = `<strong class="author">${author}:</strong> ${text}`;
                chatBox.appendChild(div);
            });
            chatBox.scrollTop = chatBox.scrollHeight;
        });

        socket.on('connect', () => console.log("Connected!"));
    </script>
</body>
</html>